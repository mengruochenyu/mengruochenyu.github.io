<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="MenuMapper">

	<resultMap type="Menu" id="menuResultMap">
		<id column="menu_id" property="menuId"/>
		<result column="menu_name" property="menuName"/>
		<result column="menu_url" property="menuUrl"/>
		<result column="parent_id" property="parentId"/>
		<result column="menu_order" property="menuOrder"/>
		<result column="menu_icon" property="menuIcon"/>
		<result column="menu_type" property="menuType"/>
	</resultMap>
	
	<!-- ztree -->
	<resultMap type="Menu" id="menuZtreeResultMap">
		<id column="menu_id" property="menuId"/>
		<result column="menu_name" property="menuName"/>
		<result column="menu_url" property="menuUrl"/>
		<result column="parent_id" property="parentId"/>
		<result column="menu_order" property="menuOrder"/>
		<result column="menu_icon" property="menuIcon"/>
		<result column="menu_type" property="menuType"/>
	<result column="target" property="target"></result>
</resultMap>

	<select id="findMaxId" parameterType="pd" resultType="java.lang.Long">
		select max(menu_id) mid from sys_menu
	</select>
	
	<select id="listAllParentMenu" resultMap="menuResultMap">
		select * from sys_menu 
		where parent_id = '0' order by menu_order 
	</select>
	
	<select id="listSubMenuByParentId" parameterType="String" resultMap="menuResultMap">
		select  * from sys_menu
		where parent_id = #{parentId} order by menu_order 
	</select>
		
	<select id="getMenuById" parameterType="pd" resultType="pd">
		select  menu_id,
		 		menu_name,
		 		menu_url,
		 		parent_id,
		 		menu_order,
		 		menu_type
		 from sys_menu 
		 where menu_id=#{menuId}
	</select>
	
	
	<insert id="insertMenu" parameterType="Menu">
		insert into sys_menu (
			menu_id,
			menu_name,
			menu_url,
			parent_id,
			menu_order,
			menu_type
		) values (
			#{menuId},
			#{menuName},
			#{menuUrl},
			#{parentId},
			#{menuOrder},
			#{menuType}
		)
	</insert>
	
	<update id="updateMenu" parameterType="Menu">
		update sys_menu set 
			menu_name =#{menuName},
			menu_url  =#{menuUrl} ,
			parent_id =#{parentId},
			menu_order=#{menuOrder}
			<if test="menu_type!=null and menu_type!=''">
				,menu_type =#{menuType}
			</if>
		where 
			menu_id=#{menuId}
	</update>
	
	<update id="editicon" parameterType="Menu">
		update sys_menu set 
			menu_icon=#{menuIcon}
		where menu_id=#{menuId}
	</update>
	
	<update id="editType" parameterType="Menu">
		update sys_menu set 
			menu_type=#{menuType}
		where parent_id=#{menuId}
	</update>
	
	<delete id="deleteMenuById" parameterType="String">
		delete from sys_menu 
		where menu_id=#{menuId} 
		or parent_id=#{menuId}
	</delete>
</mapper>